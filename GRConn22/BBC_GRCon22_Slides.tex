\ifdefined\ishandout
	\documentclass[xcolor=x11names,compress,handout]{beamer}
\else
	  \documentclass[xcolor=x11names,compress]{beamer}
\fi


\def\thisterm{September 2022}

\newif\ifslidenums
\slidenumstrue  % for slide numbers

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
% inlcude the necessary packages
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\input{myPackages_slides}
\input{myShortcuts} % include the shortcuts
\input{beamer_config} % beamer configuration

\title[BBC Communications] % (optional, use only with long paper titles)
	{BBC Communications in GNURadio}

\author[Rogers and Morrison] 
{N. Rogers and J. Morrison}


\institute[USAFA] 
{United States Air Force Academy \\ 
Department of Electrical and  \\ Computer Engineering}

\date[\thisterm] 
{\thisterm}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%start the document
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\begin{document}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

	{
	    \setbeamertemplate{logo}{}
	\begin{frame}
		\titlepage
		\pgfputat{\pgfxy(1,1.5)}{\pgfbox[center,base]{\includegraphics[width=3cm]{./figures/USAFA-logo.png}}}
	\end{frame}
	}

\setbeamercovered{invisible}
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\section{Introduction}
\begin{frame}{Overview}
	\begin{textblock}{7}(0.25,5)
		\begin{itemize}
		\setlength\itemsep{12pt}
			\item BBC Overview
			\item GNURadio implementation
			\item Lessons learned
			\item Future Development
		\end{itemize}
	\end{textblock}
	
	\begin{textblock}{7}(7.75,4)
		\includegraphics[scale=0.21]{./figures/bbc_cw_mod}
	\end{textblock}
\end{frame}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\begin{frame}{What is BBC?}
\hspace{-1.25cm}\begin{tikzpicture}
	\definecolor{myblue}{RGB}{187,224,227}
	\draw[fill=blue!10!white, draw=white] (0,0) rectangle ++(6.65,10);
	\end{tikzpicture}
	
	\begin{textblock}{7.5}(0.25,3) % left blue bar space
		\begin{itemize}[<alert@+>]
		\setlength\itemsep{12pt}
			\item Keyless
			\item Concurrent-codes
			\item Spread spectrum
			\item Jam-resistant (not LPI)
			\item Invertable hash algorithm encoding
			\item Limitation: Low throughput
			\item<alert@.> Limitation: modulation type
			\item Limit: Mark Density 
		\end{itemize}
	\end{textblock}
	
	\begin{textblock}{7}(8.5,3.5) % right white space
		\only<1>{
			No pre-shared key \note{have you seen my keys graphic}
		}
		
		\only<2>{
			Can encode multiple messages in a single codeword
		}
		
		\only<3>{
			Transmitted signal size greater than message
		}
		
		\only<4>{
		
			$\longrightarrow$ Cannot remove information that exists
			
			\vspace{6pt}
			
			$\longrightarrow$ Additional information in codeword can be ignored (to an extent)
			
			\scalebox{0.6}{
			\begin{tikzpicture}
			\node[txantenna, label={[xshift=0.5cm, yshift=-0.75cm]\scriptsize Transmitter}] (tx) at (0,0) {};
			\node[txantenna, xscale=-1, label={[xshift=-0.5cm, yshift=-0.75cm]\scriptsize Jammer}] (jam) at (6,3) {};
			\draw (2.5,5.5) pic[duck/alien, duck/mask=green, duck/cape=green, scale=0.65] {duck};
			\draw[line] (1.5,1.75) -- (3, 5.5); % signal line
			\node at (1,4) {$P_{\text{signal}}$};
			\draw[line] (3.75,4.25) -- (3, 5.5); % noise line
			\node at (4,5.25) {$P_{\text{noise}}$};
		\end{tikzpicture}	
						} % end scalebox
					} 
			
		\only<5>{
			\includegraphics[scale=0.4]{./figures/glowworm}
				}
		
		\only<6>{
		\vspace{12pt}
			\includegraphics[scale=0.25]{./figures/slowmovingvehicle}
				}
			
		\only<7>{
		\vspace{24pt}
		\begin{myblock}[0.9]{Mark Density}
		\eq{
			&\mu = \dfrac{n_{\text{bits, message}}}{n_{\text{bits, codeword}}}  \\
			&\text{Limit}  \longrightarrow 0.5
		}
		

		\end{myblock}
		}
	
	\end{textblock}
\end{frame}


%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\section{Glowworm}
\begin{frame}{Encoding -- the Glowworm Hash}
	\hspace{-1.25cm}\begin{tikzpicture}
	\definecolor{myblue}{RGB}{187,224,227}
	\draw[fill=blue!10!white, draw=white] (0,0) rectangle ++(6.65,10);
	\end{tikzpicture}
	
	\begin{textblock}{7.5}(0.25,3) % left blue bar space
		\begin{itemize}[<alert@+>]
		\setlength\itemsep{12pt}
			\item Input is length of codeword
			\item Output is ``sparse'' codeword
			\item Shift register produces mark locations in codeword
			\item Shift register values depend on current substring
			\item Example $\longrightarrow$ 
			
				Message = 0011 0010 
				Codeword = 16bits
			\item<14->\alert{ $\mu =\frac{b_{\text{message}}}{b_{\text{codeword}}} = \dfrac{6}{16} = 0.375 $}
		\end{itemize}
		
	\end{textblock}
	
	\begin{textblock}{7}(8.25,3.5) % right white space
	\only<1-4>{
		\vspace{24pt}
		\includegraphics[scale=0.6]{./figures/glowworm_hash}
		\vfill
		\footnotesize{$^1$ Baird, Carlisle, Bahn. The Glowworm Hash: Increased Speed and Security for BBC Unkeyed Jam Resistance. 2012.}
	
	}
	
	\only<5->{
		\textbf{\large{MESSAGE:}}
		
		\vspace{12pt}
				
		\begin{tabular}{| c |c |c |c |c |c |c |c |}
			\hline
			\alert<6->{0}
			& \alert<7->{0}
			& \alert<8->{1}
			& \alert<9->{1}
			& \alert<10->{0}
			& \alert<11->{0}
			& \alert<12->{0}
			& \alert<13->{0} 
			\\\hline
			\multicolumn{1}{c}{\scriptsize 0} 
			& \multicolumn{1}{c}{\scriptsize 1} 
			& \multicolumn{1}{c}{\scriptsize 2} 
			&\multicolumn{1}{c}{\scriptsize 3} 
			&\multicolumn{1}{c}{\scriptsize 4} 
			&\multicolumn{1}{c}{\scriptsize 5} 
			&\multicolumn{1}{c}{\scriptsize 6} 
			&\multicolumn{1}{c}{\scriptsize 7} \\	
		\end{tabular}
		
		\vspace{24pt} 
		\textbf{\large{GLOWWORM HASH: \hspace{2pt} }}%
		 \alert{%
		 	\only<6>{5}%
		 	\only<7>{0}%
		 	\only<8>{14}%
		 	\only<9>{2}%
		 	\only<10>{0}%
		 	\only<11>{0}%
		 	\only<12>{3}%
		 	\only<13>{12}%
		 }% end alert
				
		\vspace{24pt}
		
		\textbf{\large{CODEWORD:}}
		
		\vspace{12pt}
		
		\begin{tabular}{| c |c |c |c |c |c |c |c |}
			\hline
			 \only<5-6>{0} \only<7->{\alert<7,10,11>{1}}
			& 0
			& \only<5-8>{0} \only<9->{\alert<9>{1}}
			& \only<5-11>{0} \only<12->{\alert<12>{1}}
			& \only<5>{0} \only<6->{\alert<6>{1}}
			& 0
			& 0
			& 0 
			\\\hline
			\multicolumn{1}{c}{\scriptsize 0} 
			& \multicolumn{1}{c}{\scriptsize 1} 
			& \multicolumn{1}{c}{\scriptsize 2} 
			&\multicolumn{1}{c}{\scriptsize 3} 
			&\multicolumn{1}{c}{\scriptsize 4} 
			&\multicolumn{1}{c}{\scriptsize 5} 
			&\multicolumn{1}{c}{\scriptsize 6} 
			&\multicolumn{1}{c}{\scriptsize 7 $\ldots$} \\	
		\hline
			0
			& 0
			& 0
			& 0
			& \only<5-12>{0} \only<13->{\alert<13>{1}}
			& 0
			& \only<5-7>{0} \only<8->{\alert<8>{1}}
			& 0 
			\\\hline
			\multicolumn{1}{c}{\scriptsize 8} 
			& \multicolumn{1}{c}{\scriptsize 9} 
			& \multicolumn{1}{c}{\scriptsize 1} 
			&\multicolumn{1}{c}{\scriptsize 11} 
			&\multicolumn{1}{c}{\scriptsize 12} 
			&\multicolumn{1}{c}{\scriptsize 13} 
			&\multicolumn{1}{c}{\scriptsize 14} 
			&\multicolumn{1}{c}{\scriptsize 15} \\	
	\end{tabular}
	}


	\end{textblock}
\end{frame}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\begin{frame}{Decoding}

	\begin{textblock}{5}(0.5,3.5)
		\begin{itemize}
			\item Depth-First Search:
				\itm{
					\item Inuitive to implement, 
					\item Stack depth 
					\item Inefficient use of memory
					}
			\item Breadth-First Search
				\itm{
					\item More difficult to implement
					\item Memory / CPU efficient
					}
		\end{itemize}
	\end{textblock}
	\begin{textblock}{10}(6,3)
		\includegraphics[scale=0.5]{./images/decoder_search_tree}
	\end{textblock}
\end{frame}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\begin{frame}{Jam-Resistance}

	\begin{textblock}{14.5}(0.5,3.5)
		Jamming acts as a bit-wise ``OR''
		\vspace{-12pt}
		 \begin{center}
		 \renewcommand\arraystretch{1.5}
		    \begin{tabular}{ | m{10em} | m{2cm}| m{4.5cm} | } 
		      \hline
		      Origin & ASCII Character & BBC Codeword \\ 
		      \hline\hline
		      Original message (TX) & 2 &  10011100  00001010\\ 
		      \hline
		      Jamming signal        & ! &  01000001  10001101\\ 
		      \hline\hline
		      \textbf{Channel packet (OR)}   &  \textbf{N/A} & \textbf{ 11011101  10001111} \\ 
		      \hline
		   \end{tabular}
		    \end{center}
	\begin{itemize}
		\item Broadband noise attack $\longrightarrow$ enough energy wins (always)
		\item Random marks add additional messages, don't affect existing
		\item Checksum bits protect against hallucinations
	\end{itemize}
	\end{textblock}
\end{frame}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\section{GNURadio}
\begin{frame}{BBC In GNURadio - Encode/Decode}
	\begin{textblock}{14.5}(0.5,3.5)
		\includegraphics[scale=0.45]{./figures/GRCCodec_Multiple Messages}
	\end{textblock}
	
	\only<2>{
	\begin{textblock}{7}(0.5,2.5)
		\begin{myblock}[1]{Details}
		\begin{itemize}
			\item  Encoder
			\begin{itemize}
				\item Input = bytes vectors of length MESSAGE LENGTH
				\item Output = bytes vectors of length CODEWORD LENGTH
			\end{itemize}
			\item Decoder
			\begin{itemize}
				\item Input =bytes vectors of length CODEWORD LENGTH
				\item Output = bytes vectors of length MESSAGE LENGTH
			\end{itemize}
		\end{itemize}
		\end{myblock}
	\end{textblock}
	}  % end only
	
	
	\begin{textblock}{3}(8.25,7.25)
		\begin{tikzpicture}
			\draw[red!80!black,thick] (0,-1) rectangle ++(2,2.25);
		\end{tikzpicture}
	\end{textblock}
\end{frame}


%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\begin{frame}{Basic Testing -- Packet Density Limit}

	\begin{textblock}{14.5}(0.5,3.5)
		\includegraphics[scale=0.45]{./figures/GRCCodec_Fake marks}
	\end{textblock}
	
	
	\only<2>{
	\begin{textblock}{7}(0.5,2.5)
		\begin{myblock}[1]{Details}
		\begin{itemize}
			\item  Replaced message2 with vector source
			\item Idea is to test $\mu = $50\% mark density 
			\item $26_{10} = 00011010_{2}$ (hovering around limit)
			
			{\color{green!50!black}{PASS}}
			
			\item $27_{10} = 00011011_{2}$  (over limit)
			
			\alert{FAIL}
			 
		\end{itemize}
		\end{myblock}
	\end{textblock}
	}  % end only
	
	\begin{textblock}{3}(9.75,8)
		\begin{tikzpicture}
			\draw[red!80!black,thick] (0,-1.5) rectangle ++(2,1.75);
		\end{tikzpicture}
	\end{textblock}
	
\end{frame}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\begin{frame}{OOK Implementation}
	
	\begin{textblock}{14.5}(0.5,3.5)
		\begin{itemize}
			\item Chose OOK for simplicity
			\item Complements jam-resistance of BBC
		\end{itemize}
		\includegraphics[scale=0.45]{./figures/bbc_ook_1}
		
		\includegraphics[scale=0.45]{./figures/bbc_ook_2}
	\end{textblock}
\end{frame}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\begin{frame}{OOK Implementation}
	
	\begin{textblock}{14.5}(0.5,3.25)
		\begin{itemize}
			\item Custom OOK decoder counts 1/0 samples, assembles bits
			\item Sends codeword as bytes over message port as PMT.intern()
			\item BBC Decoder modified to receive bytes/re-assemble codewords
			\item Outputs messages 
		\end{itemize}
		\vspace{0pt}
		\includegraphics[scale=0.45]{./figures/bbc_ook_2}
	\end{textblock}
\end{frame}


%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\section{Summary}
\begin{frame}{Lessons Learned}

	\begin{textblock}{14.5}(0.5,3.5)
		\begin{itemize}
			\item Flow control through GNURadio can be a challenge
			\item Data types matter
			\item Sometimes, you just need a PMT (for async outputs)
			\item Block development documentation difficult to follow
			\item Ideally, should use bytes output from OOK decoder

		\end{itemize}
	\end{textblock}
\end{frame}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\begin{frame}{Summary \& What's Next?}

	\begin{textblock}{14.5}(0.5,3.5)
		\begin{itemize}
			\item Fix bytes between OOK and BBC decoder
			\item Package for CGAN
			\item Computational efficiency testing
			\item Hardware testing/implementation
			\item Active statistical thresholding
			\item Multimark BBC
			\item Codeword detection using ring buffer
		\end{itemize}
	\end{textblock}
\end{frame}

\end{document}
